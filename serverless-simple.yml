org: brandolc18
service: api-diagramas

frameworkVersion: "3"

provider:
  name: aws
  runtime: python3.9
  region: us-east-1
  memorySize: 512
  timeout: 30
  role: arn:aws:iam::248056481657:role/LabRole
  environment:
    STAGE: ${opt:stage, 'dev'}

functions:
  generarDiagrama:
    handler: handler.generar_diagrama
    events:
      - http:
          path: /generar-diagrama
          method: post
          cors:
            origin: "*"
            headers:
              - Content-Type
              - X-Amz-Date
              - Authorization
              - X-Api-Key
              - X-Amz-Security-Token
            allowCredentials: false
      - http:
          path: /generar-diagrama
          method: options
          cors:
            origin: "*"
            headers:
              - Content-Type
              - X-Amz-Date
              - Authorization
              - X-Api-Key
              - X-Amz-Security-Token
            allowCredentials: false

plugins:
  - serverless-python-requirements

custom:
  pythonRequirements:
    dockerizePip: true
    slim: true
    layer:
      name: ${self:service}-requirements-${opt:stage, 'dev'}
      description: Python requirements layer
      compatibleRuntimes:
        - python3.9
